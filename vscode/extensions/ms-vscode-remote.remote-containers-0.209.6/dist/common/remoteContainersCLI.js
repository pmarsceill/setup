/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------------------------------------------*/

var m=Object.create;var i=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var d=e=>i(e,"__esModule",{value:!0});var P=(e,t)=>{d(e);for(var n in t)i(e,n,{get:t[n],enumerable:!0})},O=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of C(t))!E.call(e,o)&&o!=="default"&&i(e,o,{get:()=>t[o],enumerable:!(n=h(t,o))||n.enumerable});return e},R=e=>O(d(i(e!=null?m(x(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);P(exports,{getCredential:()=>f});var p=R(require("http")),a=process.env.REMOTE_CONTAINERS_IPC;function f(e){let t={get:"fill",store:"approve",erase:"reject"}[e];if(t===void 0){console.log("Expected get, store or erase.");return}let n="";process.stdin.setEncoding("utf8"),process.stdin.on("data",o=>{n+=o,(n===`
`||n.indexOf(`

`,n.length-2)!==-1)&&(process.stdin.pause(),u(t,n).catch(console.error))}),process.stdin.on("end",()=>{u(t,n).catch(console.error)})}async function u(e,t){let n=await j({command:e,stdin:t});n||process.exit(-1);let{stdout:o,stderr:s,code:r}=JSON.parse(n);o&&process.stdout.write(o),s&&process.stderr.write(s),r&&process.exit(r)}function j(e){return new Promise(t=>{let n=JSON.stringify(e);if(!a){console.error("Remote-Containers CLI: RPC pipe not configured. Message: "+n),t(void 0);return}let s=p.request({socketPath:a,path:"/",method:"POST"},r=>{let c=[];r.setEncoding("utf8"),r.on("data",l=>{c.push(l)}),r.on("error",()=>g("Error in response")),r.on("end",()=>{t(c.join(""))})});s.on("error",()=>g("Error in request")),s.write(n),s.end()})}function g(e){console.error("Unable to connect to VS Code Remote-Containers extension."),console.error(e),process.exit(1)}f(process.argv[2]);0&&(module.exports={getCredential});
//# sourceMappingURL=remoteContainersCLI.js.map
